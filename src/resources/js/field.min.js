/**
 * Code Highlighter Field
 * 
 * Provides syntax-highlighted code editing in Craft CP
 * Uses bililiteRange library for contenteditable handling (MIT License)
 * https://github.com/dwachss/bililiteRange
 * 
 * @copyright Copyright (c) 2025 LindemannRock
 */
!function(e){"use strict";e.fn.codeHighlighterField=function(t){return this.each(function(){var t=e(this),n=t.find("code"),i=t.find("textarea"),a=n[0];if(a&&i.length){var l=bililiteRange.fancyText(a,function(e){"undefined"!=typeof Prism&&Prism.highlightElement(e)});bililiteRange(l).undo(0).data().autoindent=!0,n.on("keydown",function(e){switch(e.keyCode){case 9:e.preventDefault(),n.sendkeys("\t");break;case 219:(e.ctrlKey||e.metaKey)&&(e.preventDefault(),bililiteRange(a).bounds("selection").unindent());break;case 221:(e.ctrlKey||e.metaKey)&&(e.preventDefault(),bililiteRange(a).bounds("selection").indent("\t"))}(e.ctrlKey||e.metaKey)&&90===e.keyCode&&(e.preventDefault(),bililiteRange.undo(e)),(e.ctrlKey||e.metaKey)&&89===e.keyCode&&(e.preventDefault(),bililiteRange.redo(e))}),n.on("keyup",o),n.on("paste",function(){setTimeout(o,10)}),o()}else console.warn("Code Highlighter: Missing code or textarea element");function o(){var e=bililiteRange(a).text();i.val(e),i.trigger("input").trigger("change")}})}}(jQuery);